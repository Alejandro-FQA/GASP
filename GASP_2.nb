(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    100380,       2608]
NotebookOptionsPosition[     93588,       2496]
NotebookOutlinePosition[     93974,       2512]
CellTagsIndexPosition[     93931,       2509]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "the", " ", "wave", " ", "function", " ", "explicitly"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "\[Psi]", ",", "x", ",", "xr", ",", "xi", ",", "pr", ",", "pi", ",", 
     "d\[Psi]dxr", ",", "d\[Psi]dxi", ",", "d\[Psi]dx0", ",", "d\[Psi]dpr", 
     ",", "d\[Psi]dpi", ",", "d\[Psi]dp0"}], "]"}], "\n", 
   RowBox[{
    RowBox[{"\[Psi]", "[", 
     RowBox[{"x_", ",", "xr_", ",", "xi_", ",", "pr_", ",", "pi_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "\[Pi]"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"1", "/", "4"}], ")"}]}], "*", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"(", 
            RowBox[{"xr", "+", 
             RowBox[{"I", "*", "xi"}]}], ")"}]}], ")"}], "^", "2"}]}], "/", 
       "2"}], "]"}], "*", 
     RowBox[{"Exp", "[", 
      RowBox[{"I", "*", "x", "*", 
       RowBox[{"(", 
        RowBox[{"pr", "+", 
         RowBox[{"I", "*", "pi"}]}], ")"}]}], "]"}], "*", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "I"}], "/", "2"}], "*", 
       RowBox[{"(", 
        RowBox[{"xr", "+", 
         RowBox[{"I", "*", "xi"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"pr", "+", 
         RowBox[{"I", "*", "pi"}]}], ")"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Verify", " ", "\[Psi]", " ", "by", " ", "evaluating", " ", "it", " ", 
     "at", " ", "specific", " ", "values"}], "*)"}], 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "\[Element]", "Reals"}], ",", 
       RowBox[{"xr", "\[Element]", "Reals"}], ",", 
       RowBox[{"xi", "\[Element]", "Reals"}], ",", 
       RowBox[{"pr", "\[Element]", "Reals"}], ",", 
       RowBox[{"pi", "\[Element]", "Reals"}]}], "}"}], ",", 
     RowBox[{"\[Psi]", "[", 
      RowBox[{"x", ",", "xr", ",", "xi", ",", "pr", ",", "pi"}], "]"}]}], 
    "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.939370369464582*^9, 3.939370395254727*^9}, {
   3.9393704727202787`*^9, 3.939370482039238*^9}, {3.939370697264835*^9, 
   3.939370722615758*^9}, {3.939371051129489*^9, 3.939371102825221*^9}, {
   3.93937114418635*^9, 3.939371147097631*^9}, 3.939371198491087*^9, {
   3.939371840493186*^9, 3.939371857036388*^9}, {3.93937270073402*^9, 
   3.9393727238865128`*^9}, {3.939372788108437*^9, 3.939372798588064*^9}, 
   3.939811418865402*^9, 3.9398115860558147`*^9, {3.939812045469281*^9, 
   3.939812071808282*^9}, {3.9398121267035513`*^9, 3.9398121305249233`*^9}, {
   3.940398876609394*^9, 3.940399017456668*^9}, {3.940399640053138*^9, 
   3.9403996572358932`*^9}, 3.940409648604108*^9, {3.940410794431343*^9, 
   3.9404108420947037`*^9}, {3.9404109092640743`*^9, 3.940411025488737*^9}, {
   3.941174517168036*^9, 3.941174527022985*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"60137a49-2a91-4c18-b95d-8803728b1855"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "pi"}], "+", "pr"}], ")"}], " ", "x"}], 
    "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", "-", 
        RowBox[{"\[ImaginaryI]", " ", "xi"}], "-", "xr"}], ")"}], "2"]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "pi"}], "+", "pr"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "xi"}], "+", "xr"}], ")"}]}]}]], 
  SuperscriptBox["\[Pi]", 
   RowBox[{"1", "/", "4"}]]]], "Output",
 CellChangeTimes->{{3.9404108557606697`*^9, 3.9404108802757483`*^9}, 
   3.9404109237188463`*^9, {3.940411011157806*^9, 3.9404110268706284`*^9}, 
   3.941174450306566*^9, 3.941174701763461*^9, 3.941185596767765*^9, 
   3.941191079978087*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"d711cef0-cdac-4209-be52-4ba57a5fe32b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "Rule1", " ", "to", " ", "rewrite", " ", "x0"}], 
   "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{
   RowBox[{"Rulex0", "=", 
    RowBox[{
     RowBox[{"xr", "+", 
      RowBox[{"I", "*", "xi"}]}], "\[Rule]", "x0"}]}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", 
    RowBox[{"Define", " ", "Rule1", " ", "to", " ", "rewrite", " ", "p0"}], 
    "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{"Rulep0", "=", 
    RowBox[{
     RowBox[{"pr", "+", 
      RowBox[{"I", "*", "pi"}]}], "\[Rule]", "p0"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.939370369464582*^9, 3.939370395254727*^9}, {
   3.9393704727202787`*^9, 3.939370482039238*^9}, {3.939370697264835*^9, 
   3.939370722615758*^9}, {3.939371051129489*^9, 3.939371102825221*^9}, {
   3.93937114418635*^9, 3.939371147097631*^9}, 3.939371198491087*^9, {
   3.939371840493186*^9, 3.939371857036388*^9}, {3.93937270073402*^9, 
   3.9393727238865128`*^9}, {3.939372788108437*^9, 3.939372798588064*^9}, 
   3.939811418865402*^9, 3.9398115860558147`*^9, {3.939812045469281*^9, 
   3.939812071808282*^9}, {3.9398121267035513`*^9, 3.9398121305249233`*^9}, {
   3.940399030975012*^9, 3.940399061599127*^9}, {3.9404004687891808`*^9, 
   3.940400531477058*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"6b4ee172-6b1c-4349-b30c-2d9d9c46ac70"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[ImaginaryI]", " ", "xi"}], "+", "xr"}], "\[Rule]", 
  "x0"}]], "Output",
 CellChangeTimes->{3.941174701912917*^9, 3.9411855968730297`*^9, 
  3.9411910801658373`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"b1e2c95e-0609-4c7f-bbf4-807d6a6f6f01"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[ImaginaryI]", " ", "pi"}], "+", "pr"}], "\[Rule]", 
  "p0"}]], "Output",
 CellChangeTimes->{3.941174701912917*^9, 3.9411855968730297`*^9, 
  3.9411910801672564`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"61ca0e2f-55f1-4761-ab7d-42b2708b874b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Verify", " ", "\[Psi]", " ", "is", " ", "normalized"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Psi]\[Psi]", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"\[Psi]", "[", 
           RowBox[{"x", ",", "xr", ",", "xi", ",", "pr", ",", "pi"}], "]"}], 
          "]"}], 
         RowBox[{"\[Psi]", "[", 
          RowBox[{"x", ",", "xr", ",", "xi", ",", "pr", ",", "pi"}], "]"}]}], 
        "/.", "Rulex0"}], "/.", "Rulep0"}], "//", "ComplexExpand"}], " ", "//",
      "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    TemplateBox[{"\[Psi]", "\[Psi]"},
     "BraKet"], "=", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
     RowBox[{"\[Psi]\[Psi]", 
      RowBox[{"\[DifferentialD]", "x", " "}]}]}]}]}]}]], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"4f693eab-65e9-4505-af33-f87d7b732c95"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    SuperscriptBox["xi", "2"], "-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x", "-", "xr"}], ")"}], "2"]}]], 
  SqrtBox["\[Pi]"]]], "Output",
 CellChangeTimes->{
  3.940400561219726*^9, 3.940401107754125*^9, 3.940409652246917*^9, {
   3.940409915516842*^9, 3.940409945357724*^9}, 3.940410505557671*^9, 
   3.9411744510169353`*^9, 3.941174701950246*^9, 3.941185596927909*^9, 
   3.9411910802263107`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"e37761b1-efaa-4efa-a692-521261505ce7"],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  SuperscriptBox["xi", "2"]]], "Output",
 CellChangeTimes->{
  3.940400561219726*^9, 3.940401107754125*^9, 3.940409652246917*^9, {
   3.940409915516842*^9, 3.940409945357724*^9}, 3.940410505557671*^9, 
   3.9411744510169353`*^9, 3.941174701950246*^9, 3.941185596927909*^9, 
   3.941191080733029*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"f45ce7a8-b900-4fcb-b3bf-cef1467bf3ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "the", " ", "Hamiltonian", " ", "H", " ", "as", " ", "an", 
    " ", "operator"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"H", "[", "expr_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}], "*", 
      RowBox[{"D", "[", 
       RowBox[{"expr", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"x", "^", "2"}], "*", "expr"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Apply", " ", "the", " ", "Hamiltonian", " ", "to", " ", "\[Psi]", " ", 
     "and", " ", "simplify"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"H\[Psi]", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"H", "[", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"x", ",", "xr", ",", "xi", ",", "pr", ",", "pi"}], "]"}], 
        "]"}], "/.", "Rulex0"}], "/.", "Rulep0"}], "//", "Simplify"}]}], " ", 
   "\n"}]}]], "Input",
 CellChangeTimes->{{3.939370480638755*^9, 3.939370488454667*^9}, {
   3.939370741105815*^9, 3.93937074320745*^9}, {3.939370902590519*^9, 
   3.939370909752133*^9}, {3.939371058280908*^9, 3.939371060760871*^9}, {
   3.939371108968795*^9, 3.939371131787364*^9}, {3.9393712214176073`*^9, 
   3.939371256939815*^9}, {3.939371618764449*^9, 3.939371627291294*^9}, {
   3.939371859756078*^9, 3.9393718598975782`*^9}, {3.939811453115506*^9, 
   3.939811456010475*^9}, {3.940399510979291*^9, 3.94039951651468*^9}, {
   3.940400543382987*^9, 3.940400556166061*^9}, {3.940400640408599*^9, 
   3.94040064286895*^9}, {3.940400685432259*^9, 3.940400754821671*^9}, 
   3.940410124263473*^9},
 CellLabel->"In[8]:=",ExpressionUUID->"06cc94a1-2d62-4d9a-9d46-480ba8280cc7"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "p0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "x"}], "-", "x0"}], ")"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "x"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "xi"}], "+", "xr"}], ")"}], "2"]}]}]], 
   " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["p0", "2"], "+", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "p0", " ", 
      RowBox[{"(", 
       RowBox[{"x", "-", "x0"}], ")"}]}], "+", 
     RowBox[{"2", " ", "x", " ", "x0"}], "-", 
     SuperscriptBox["x0", "2"]}], ")"}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox["\[Pi]", 
    RowBox[{"1", "/", "4"}]]}]]], "Output",
 CellChangeTimes->{
  3.9398114725845203`*^9, 3.939811612391902*^9, {3.939812052751543*^9, 
   3.939812076000228*^9}, 3.939812133770616*^9, 3.9398122634631157`*^9, 
   3.940399773091817*^9, 3.94040057722075*^9, 3.940400649130311*^9, {
   3.94040070379395*^9, 3.940400755820141*^9}, 3.940401107992763*^9, 
   3.940409652517836*^9, {3.9404099155596867`*^9, 3.940409945407053*^9}, 
   3.940410125632305*^9, 3.9404105056459723`*^9, 3.9411744511295757`*^9, 
   3.9411747024397697`*^9, 3.941185597400898*^9, 3.94119108076548*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"98d42924-b0ae-4564-bf7e-2ca138698740"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Partial", " ", "derivative", " ", "of", " ", "\[Psi]", " ", "with", " ", 
    "respect", " ", "to", " ", "xr"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"d\[Psi]dxr", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Psi]", "[", 
          RowBox[{"x", ",", "xr", ",", "xi", ",", "pr", ",", "pi"}], "]"}], 
         ",", "xr"}], "]"}], "/.", "Rulex0"}], "/.", "Rulep0"}], "//", 
     "FullSimplify"}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Partial", " ", "derivative", " ", "of", " ", "\[Psi]", " ", "with", " ", 
     "respect", " ", "to", " ", "xi"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"d\[Psi]dxi", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Psi]", "[", 
          RowBox[{"x", ",", "xr", ",", "xi", ",", "pr", ",", "pi"}], "]"}], 
         ",", "xi"}], "]"}], "/.", "Rulex0"}], "/.", "Rulep0"}], "//", 
     "FullSimplify"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Partial", " ", "derivative", " ", "of", " ", "\[Psi]", " ", "with", " ", 
     "respect", " ", "to", " ", "pr"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"d\[Psi]dpr", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Psi]", "[", 
          RowBox[{"x", ",", "xr", ",", "xi", ",", "pr", ",", "pi"}], "]"}], 
         ",", "pr"}], "]"}], "/.", "Rulex0"}], "/.", "Rulep0"}], "//", 
     "FullSimplify"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Partial", " ", "derivative", " ", "of", " ", "\[Psi]", " ", "with", " ", 
     "respect", " ", "to", " ", "pi"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"d\[Psi]dpi", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Psi]", "[", 
          RowBox[{"x", ",", "xr", ",", "xi", ",", "pr", ",", "pi"}], "]"}], 
         ",", "pi"}], "]"}], "/.", "Rulex0"}], "/.", "Rulep0"}], "//", 
     "FullSimplify"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Partial", " ", "derivative", " ", "of", " ", "\[Psi]", " ", "with", " ", 
     "respect", " ", "to", " ", "x0"}], "*)"}], "\n", 
   RowBox[{"d\[Psi]dx0", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d\[Psi]dxr", " ", "-", 
          RowBox[{"I", " ", "d\[Psi]dxi"}]}], ")"}], "/", "2"}], "/.", 
       "Rulex0"}], "/.", "Rulep0"}], "//", "FullSimplify"}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Partial", " ", "derivative", " ", "of", " ", "\[Psi]", " ", "with", " ", 
     "respect", " ", "to", " ", "p0"}], "*)"}], "\n", 
   RowBox[{"d\[Psi]dp0", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d\[Psi]dpr", " ", "-", 
          RowBox[{"I", " ", "d\[Psi]dpi"}]}], ")"}], "/", "2"}], "/.", 
       "Rulex0"}], "/.", "Rulep0"}], "//", "FullSimplify"}]}], 
   "\[IndentingNewLine]", "\n"}]}]], "Input",
 CellChangeTimes->{{3.939370496591666*^9, 3.939370499431224*^9}, {
   3.9393707640820827`*^9, 3.939370766345334*^9}, {3.939375017526416*^9, 
   3.9393750189624777`*^9}, {3.9393799601109953`*^9, 3.939379979069906*^9}, {
   3.939380011663541*^9, 3.939380013886086*^9}, {3.9398103941037703`*^9, 
   3.939810440247263*^9}, {3.939810608872027*^9, 3.939810609463311*^9}, {
   3.939810725979374*^9, 3.939810734328314*^9}, {3.939810865821402*^9, 
   3.9398108715936947`*^9}, {3.939811226960485*^9, 3.939811253609376*^9}, {
   3.939811459888629*^9, 3.939811469722907*^9}, {3.939812152014*^9, 
   3.939812161404269*^9}, {3.940399529955673*^9, 3.94039963045122*^9}, {
   3.940400764344306*^9, 3.940400768950383*^9}, {3.940400987177422*^9, 
   3.940401010871715*^9}, 3.9404010467927628`*^9, {3.9404097642887783`*^9, 
   3.9404097809112988`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"f84e76fa-e81a-428c-9670-3371db984597"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "p0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "x"}], "-", "x0"}], ")"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "x"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "xi"}], "+", "xr"}], ")"}], "2"]}]}]], 
   " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "p0"}], "2"]}], "+", "x", "-", 
     RowBox[{"\[ImaginaryI]", " ", "xi"}], "-", "xr"}], ")"}]}], 
  SuperscriptBox["\[Pi]", 
   RowBox[{"1", "/", "4"}]]]], "Output",
 CellChangeTimes->{
  3.939811472633046*^9, 3.939811612420598*^9, {3.939812052790894*^9, 
   3.9398120761741247`*^9}, {3.939812133805653*^9, 3.939812162517579*^9}, 
   3.939812263507311*^9, 3.940399783060154*^9, 3.940400583613196*^9, 
   3.940400778529134*^9, 3.9404009940938473`*^9, {3.940401032607148*^9, 
   3.940401049093685*^9}, 3.94040110806098*^9, 3.940409652582398*^9, {
   3.9404097682086973`*^9, 3.940409782909535*^9}, {3.940409915597369*^9, 
   3.940409945512661*^9}, 3.940410144762738*^9, 3.9404105057225733`*^9, 
   3.941174451340167*^9, 3.941174702494912*^9, 3.9411855975151863`*^9, 
   3.9411910808685226`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"f56f1dbb-bd09-4ef4-b506-16e0d7dfbe9a"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "p0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "x"}], "-", "x0"}], ")"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "x"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "xi"}], "+", "xr"}], ")"}], "2"]}]}]], 
   " ", 
   RowBox[{"(", 
    RowBox[{"p0", "+", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "x"}], "+", 
     RowBox[{"2", " ", "xi"}], "-", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "xr"}]}], ")"}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox["\[Pi]", 
    RowBox[{"1", "/", "4"}]]}]]], "Output",
 CellChangeTimes->{
  3.939811472633046*^9, 3.939811612420598*^9, {3.939812052790894*^9, 
   3.9398120761741247`*^9}, {3.939812133805653*^9, 3.939812162517579*^9}, 
   3.939812263507311*^9, 3.940399783060154*^9, 3.940400583613196*^9, 
   3.940400778529134*^9, 3.9404009940938473`*^9, {3.940401032607148*^9, 
   3.940401049093685*^9}, 3.94040110806098*^9, 3.940409652582398*^9, {
   3.9404097682086973`*^9, 3.940409782909535*^9}, {3.940409915597369*^9, 
   3.940409945512661*^9}, 3.940410144762738*^9, 3.9404105057225733`*^9, 
   3.941174451340167*^9, 3.941174702494912*^9, 3.9411855975151863`*^9, 
   3.941191080923369*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"c5082a25-725a-45c7-9899-364e0cc42fa4"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "p0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "x"}], "-", "x0"}], ")"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "x"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "xi"}], "+", "xr"}], ")"}], "2"]}]}]], 
   " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "x"}], "-", "x0"}], ")"}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox["\[Pi]", 
    RowBox[{"1", "/", "4"}]]}]]], "Output",
 CellChangeTimes->{
  3.939811472633046*^9, 3.939811612420598*^9, {3.939812052790894*^9, 
   3.9398120761741247`*^9}, {3.939812133805653*^9, 3.939812162517579*^9}, 
   3.939812263507311*^9, 3.940399783060154*^9, 3.940400583613196*^9, 
   3.940400778529134*^9, 3.9404009940938473`*^9, {3.940401032607148*^9, 
   3.940401049093685*^9}, 3.94040110806098*^9, 3.940409652582398*^9, {
   3.9404097682086973`*^9, 3.940409782909535*^9}, {3.940409915597369*^9, 
   3.940409945512661*^9}, 3.940410144762738*^9, 3.9404105057225733`*^9, 
   3.941174451340167*^9, 3.941174702494912*^9, 3.9411855975151863`*^9, 
   3.94119108097082*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"5c7ce784-c4e1-4cae-8d1b-3895c98ea225"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "p0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "x"}], "-", "x0"}], ")"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "x"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "xi"}], "+", "xr"}], ")"}], "2"]}]}]], 
   " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "x"}], "+", "x0"}], ")"}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox["\[Pi]", 
    RowBox[{"1", "/", "4"}]]}]]], "Output",
 CellChangeTimes->{
  3.939811472633046*^9, 3.939811612420598*^9, {3.939812052790894*^9, 
   3.9398120761741247`*^9}, {3.939812133805653*^9, 3.939812162517579*^9}, 
   3.939812263507311*^9, 3.940399783060154*^9, 3.940400583613196*^9, 
   3.940400778529134*^9, 3.9404009940938473`*^9, {3.940401032607148*^9, 
   3.940401049093685*^9}, 3.94040110806098*^9, 3.940409652582398*^9, {
   3.9404097682086973`*^9, 3.940409782909535*^9}, {3.940409915597369*^9, 
   3.940409945512661*^9}, 3.940410144762738*^9, 3.9404105057225733`*^9, 
   3.941174451340167*^9, 3.941174702494912*^9, 3.9411855975151863`*^9, 
   3.941191081015832*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"6cf8d2e8-a724-4fee-aaa8-11e1944fcc05"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x", "-", "x0"}], ")"}], "2"]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "p0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "x"}], "-", "x0"}], ")"}]}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "p0"}], "+", 
     RowBox[{"2", " ", "x"}], "-", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "xi"}], "-", 
     RowBox[{"2", " ", "xr"}]}], ")"}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox["\[Pi]", 
    RowBox[{"1", "/", "4"}]]}]]], "Output",
 CellChangeTimes->{
  3.939811472633046*^9, 3.939811612420598*^9, {3.939812052790894*^9, 
   3.9398120761741247`*^9}, {3.939812133805653*^9, 3.939812162517579*^9}, 
   3.939812263507311*^9, 3.940399783060154*^9, 3.940400583613196*^9, 
   3.940400778529134*^9, 3.9404009940938473`*^9, {3.940401032607148*^9, 
   3.940401049093685*^9}, 3.94040110806098*^9, 3.940409652582398*^9, {
   3.9404097682086973`*^9, 3.940409782909535*^9}, {3.940409915597369*^9, 
   3.940409945512661*^9}, 3.940410144762738*^9, 3.9404105057225733`*^9, 
   3.941174451340167*^9, 3.941174702494912*^9, 3.9411855975151863`*^9, 
   3.9411910811134253`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"7bcb6b7a-18a5-4515-bd50-8ce9b9a8b2d0"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x", "-", "x0"}], ")"}], "2"]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "p0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "x"}], "-", "x0"}], ")"}]}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "x"}], "-", "x0"}], ")"}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox["\[Pi]", 
    RowBox[{"1", "/", "4"}]]}]]], "Output",
 CellChangeTimes->{
  3.939811472633046*^9, 3.939811612420598*^9, {3.939812052790894*^9, 
   3.9398120761741247`*^9}, {3.939812133805653*^9, 3.939812162517579*^9}, 
   3.939812263507311*^9, 3.940399783060154*^9, 3.940400583613196*^9, 
   3.940400778529134*^9, 3.9404009940938473`*^9, {3.940401032607148*^9, 
   3.940401049093685*^9}, 3.94040110806098*^9, 3.940409652582398*^9, {
   3.9404097682086973`*^9, 3.940409782909535*^9}, {3.940409915597369*^9, 
   3.940409945512661*^9}, 3.940410144762738*^9, 3.9404105057225733`*^9, 
   3.941174451340167*^9, 3.941174702494912*^9, 3.9411855975151863`*^9, 
   3.9411910811585217`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"65b5b093-6ea0-44d9-a528-09ae4c4d2e45"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Compute", " ", 
    TemplateBox[{"\[Psi]"},
     "Bra"], "H", 
    TemplateBox[{"\[Psi]"},
     "Ket"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Psi]H\[Psi]", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"\[Psi]", "[", 
           RowBox[{"x", ",", "xr", ",", "xi", ",", "pr", ",", "pi"}], "]"}], 
          "]"}], "H\[Psi]"}], "/.", "Rulex0"}], "/.", "Rulep0"}], "//", 
      "ComplexExpand"}], " ", "//", "FullSimplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    TemplateBox[{"\[Psi]", "H\[Psi]"},
     "BraKet"], "=", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
     RowBox[{"\[Psi]H\[Psi]", 
      RowBox[{"\[DifferentialD]", "x", " "}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.93937257468305*^9, 3.939372618779162*^9}, {
   3.93937272867117*^9, 3.939372732683766*^9}, {3.939372838701035*^9, 
   3.93937285612381*^9}, {3.939373055778446*^9, 3.9393731010685883`*^9}, {
   3.939373209651136*^9, 3.9393732593092003`*^9}, {3.939374145173314*^9, 
   3.93937416412786*^9}, 3.939380823252524*^9, {3.939380899090044*^9, 
   3.93938093206411*^9}, {3.939380978289502*^9, 3.939380994224566*^9}, {
   3.9403996745818787`*^9, 3.9403996765162888`*^9}, 3.940401066330065*^9, 
   3.940409888661344*^9, {3.9404102367613153`*^9, 3.940410278666369*^9}, {
   3.9411773830794563`*^9, 3.941177424907605*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"ddac95f2-8796-4525-b673-e752a83e32c8"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["x", "2"]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["x0", "2"]}], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"xi", "+", 
           RowBox[{"\[ImaginaryI]", " ", "xr"}]}], ")"}], "2"]}], ")"}]}], 
     "+", 
     RowBox[{"x", " ", 
      RowBox[{"(", 
       RowBox[{"x0", "-", 
        RowBox[{"\[ImaginaryI]", " ", "xi"}], "+", "xr"}], ")"}]}]}]], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p0", "-", 
        RowBox[{"\[ImaginaryI]", " ", "x0"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"p0", "+", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "x"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "x0"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{"2", " ", 
   SqrtBox["\[Pi]"]}]]], "Output",
 CellChangeTimes->{{3.939372609419066*^9, 3.939372620106329*^9}, 
   3.9393727395838337`*^9, 3.939372808325758*^9, {3.939372843576654*^9, 
   3.939372856781959*^9}, 3.939373102879286*^9, 3.939373272086144*^9, 
   3.939380902575262*^9, 3.939380985235173*^9, 3.93938141723389*^9, 
   3.939381532509495*^9, 3.939810445150504*^9, 3.939810554399097*^9, 
   3.9398114726845407`*^9, 3.939811612462674*^9, {3.939812052834358*^9, 
   3.939812076268461*^9}, 3.939812133884582*^9, 3.939812263557581*^9, 
   3.9403998113653107`*^9, 3.9404005895787067`*^9, 3.940401069975617*^9, 
   3.940401108344708*^9, 3.940409652911797*^9, {3.9404098904182987`*^9, 
   3.940409945571957*^9}, {3.94041023916366*^9, 3.940410280963532*^9}, 
   3.940410505769272*^9, 3.941174452256381*^9, 3.941174702676915*^9, {
   3.941177385014786*^9, 3.9411774263073463`*^9}, 3.9411855984188623`*^9, 
   3.941191081927586*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"35a2fcea-534f-41ed-add8-a3424c3365de"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x0", "+", 
       RowBox[{"\[ImaginaryI]", " ", "xi"}], "-", "xr"}], ")"}], "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p0", "-", 
       RowBox[{"\[ImaginaryI]", " ", "x0"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"p0", "+", "xi", "+", 
       RowBox[{"\[ImaginaryI]", " ", "xr"}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.939372609419066*^9, 3.939372620106329*^9}, 
   3.9393727395838337`*^9, 3.939372808325758*^9, {3.939372843576654*^9, 
   3.939372856781959*^9}, 3.939373102879286*^9, 3.939373272086144*^9, 
   3.939380902575262*^9, 3.939380985235173*^9, 3.93938141723389*^9, 
   3.939381532509495*^9, 3.939810445150504*^9, 3.939810554399097*^9, 
   3.9398114726845407`*^9, 3.939811612462674*^9, {3.939812052834358*^9, 
   3.939812076268461*^9}, 3.939812133884582*^9, 3.939812263557581*^9, 
   3.9403998113653107`*^9, 3.9404005895787067`*^9, 3.940401069975617*^9, 
   3.940401108344708*^9, 3.940409652911797*^9, {3.9404098904182987`*^9, 
   3.940409945571957*^9}, {3.94041023916366*^9, 3.940410280963532*^9}, 
   3.940410505769272*^9, 3.941174452256381*^9, 3.941174702676915*^9, {
   3.941177385014786*^9, 3.9411774263073463`*^9}, 3.9411855984188623`*^9, 
   3.9411910900215597`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"455596ef-0855-43e5-aad1-61f3c9916fe4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Compute", " ", 
    TemplateBox[{
      RowBox[{
        SubscriptBox["\[PartialD]", "x0"], "\[Psi]"}]},
     "Bra"], "H", 
    TemplateBox[{"\[Psi]"},
     "Ket"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"d\[Psi]dx0H\[Psi]", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", "d\[Psi]dx0", " ", "]"}], "H\[Psi]"}], "/.",
         "Rulex0"}], "/.", "Rulep0"}], "//", "ComplexExpand"}], " ", "//", 
     "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    TemplateBox[{"dx0\[Psi]", "H\[Psi]"},
     "BraKet"], "=", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
     RowBox[{"d\[Psi]dx0H\[Psi]", 
      RowBox[{"\[DifferentialD]", "x", " "}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.939374385795023*^9, 3.939374423776065*^9}, {
   3.9393744581502953`*^9, 3.9393746407212763`*^9}, {3.939374673425046*^9, 
   3.939374695185933*^9}, {3.9393750245635653`*^9, 3.939375029938963*^9}, {
   3.93937515912431*^9, 3.939375169348949*^9}, {3.939380883476824*^9, 
   3.9393808843516693`*^9}, {3.9393809612499933`*^9, 3.939380972912983*^9}, {
   3.9393813779365587`*^9, 3.9393813781297083`*^9}, {3.939381448002693*^9, 
   3.939381476529252*^9}, 3.9398104628921127`*^9, 3.9403996900210857`*^9, 
   3.940401082312093*^9, 3.940409933156802*^9, {3.941178250571015*^9, 
   3.9411782797219267`*^9}, 3.9411783184439898`*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"99c83999-f10d-4060-8082-a21c2e3ce3e7"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", "-", "x0"}], ")"}], "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["p0", "2"], "+", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "p0", " ", 
      RowBox[{"(", 
       RowBox[{"x", "-", "x0"}], ")"}]}], "+", 
     RowBox[{"2", " ", "x", " ", "x0"}], "-", 
     SuperscriptBox["x0", "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "p0"}], "+", 
     RowBox[{"2", " ", "x"}], "+", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "xi"}], "-", 
     RowBox[{"2", " ", "xr"}]}], ")"}]}], 
  RowBox[{"4", " ", 
   SqrtBox["\[Pi]"]}]]], "Output",
 CellChangeTimes->{{3.939374563412716*^9, 3.939374587006752*^9}, 
   3.939374643930573*^9, {3.9393746971586113`*^9, 3.93937471016661*^9}, 
   3.9393747542267714`*^9, 3.9393747920033693`*^9, {3.9393750261221457`*^9, 
   3.939375030551539*^9}, {3.939375160733624*^9, 3.939375170188747*^9}, 
   3.9393809649800377`*^9, 3.939381381601535*^9, 3.939381418661199*^9, 
   3.939381533671096*^9, 3.939810448048118*^9, 3.939810555383089*^9, 
   3.939811474246354*^9, 3.939811613170041*^9, {3.93981205377102*^9, 
   3.939812077235717*^9}, 3.9398121348684*^9, 3.939812264492641*^9, 
   3.9403998269561157`*^9, 3.940400596585441*^9, 3.940401109491047*^9, 
   3.940409656315683*^9, 3.94040991777678*^9, 3.940409947922323*^9, 
   3.9404105067840242`*^9, 3.941174458409824*^9, 3.941174704439074*^9, 
   3.941178282487584*^9, 3.941178319422435*^9, 3.941185602601759*^9, 
   3.9411910900906*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"b7701802-ffbf-4136-bd6c-8e294fd7073e"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["p0", "3"]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", "p0", " ", 
     RowBox[{"(", 
      RowBox[{"3", "+", 
       SuperscriptBox["x0", "2"]}], ")"}]}], "+", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", "xi"}], "+", 
    RowBox[{"2", " ", "x0", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"x0", " ", 
        RowBox[{"(", 
         RowBox[{"x0", "+", 
          RowBox[{"\[ImaginaryI]", " ", "xi"}], "-", "xr"}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["p0", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"x0", "+", 
       RowBox[{"\[ImaginaryI]", " ", "xi"}], "-", "xr"}], ")"}]}], "-", 
    RowBox[{"2", " ", "xr"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.939374563412716*^9, 3.939374587006752*^9}, 
   3.939374643930573*^9, {3.9393746971586113`*^9, 3.93937471016661*^9}, 
   3.9393747542267714`*^9, 3.9393747920033693`*^9, {3.9393750261221457`*^9, 
   3.939375030551539*^9}, {3.939375160733624*^9, 3.939375170188747*^9}, 
   3.9393809649800377`*^9, 3.939381381601535*^9, 3.939381418661199*^9, 
   3.939381533671096*^9, 3.939810448048118*^9, 3.939810555383089*^9, 
   3.939811474246354*^9, 3.939811613170041*^9, {3.93981205377102*^9, 
   3.939812077235717*^9}, 3.9398121348684*^9, 3.939812264492641*^9, 
   3.9403998269561157`*^9, 3.940400596585441*^9, 3.940401109491047*^9, 
   3.940409656315683*^9, 3.94040991777678*^9, 3.940409947922323*^9, 
   3.9404105067840242`*^9, 3.941174458409824*^9, 3.941174704439074*^9, 
   3.941178282487584*^9, 3.941178319422435*^9, 3.941185602601759*^9, 
   3.9411910966255293`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"153c56e0-ae62-40c9-9dcb-d3903dd0b208"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Compute", " ", 
    TemplateBox[{
      RowBox[{
        SubscriptBox["\[PartialD]", "p0"], "\[Psi]"}]},
     "Bra"], "H", 
    TemplateBox[{"\[Psi]"},
     "Ket"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"d\[Psi]dp0H\[Psi]", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", "d\[Psi]dp0", " ", "]"}], "H\[Psi]"}], "/.",
         "Rulex0"}], "/.", "Rulep0"}], "//", "ComplexExpand"}], "//", 
     "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    TemplateBox[{"dp0\[Psi]", "H\[Psi]"},
     "BraKet"], "=", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
     RowBox[{"d\[Psi]dp0H\[Psi]", 
      RowBox[{"\[DifferentialD]", "x"}]}]}]}], " ", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.939376595925482*^9, 3.939376612309556*^9}, {
   3.939378422748129*^9, 3.939378453082984*^9}, {3.9393808551875467`*^9, 
   3.939380856320397*^9}, {3.9393809469329863`*^9, 3.939380951776013*^9}, {
   3.9393813739055367`*^9, 3.939381374210959*^9}, {3.939381461569364*^9, 
   3.939381473921731*^9}, {3.939810494442184*^9, 3.9398104964878683`*^9}, 
   3.9403996951739073`*^9, 3.9404010841843224`*^9, 3.940409927891912*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"28569653-684f-4144-b09f-b1d31710be58"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x", "-", "x0"}], ")"}], "2"]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", 
       SuperscriptBox["x", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "p0"}], "+", "x0"}], ")"}]}], "+", 
      RowBox[{"2", " ", "x", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["p0", "2"], "-", 
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "p0", " ", "x0"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["x0", "2"]}]}], ")"}]}], "+", 
      RowBox[{"x0", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         SuperscriptBox["p0", "2"], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "p0", " ", "x0"}], "+", 
         SuperscriptBox["x0", "2"]}], ")"}]}]}], ")"}]}], 
   RowBox[{"4", " ", 
    SqrtBox["\[Pi]"]}]]}]], "Output",
 CellChangeTimes->{
  3.9393766148009872`*^9, {3.93937842439167*^9, 3.939378453663086*^9}, 
   3.939380859397151*^9, 3.939380953846798*^9, 3.939381420078651*^9, 
   3.939381535048292*^9, 3.9398104504669323`*^9, 3.9398105561335497`*^9, 
   3.939811474985277*^9, 3.939811614237043*^9, {3.9398120549371567`*^9, 
   3.939812078158002*^9}, 3.939812135798045*^9, 3.939812265382793*^9, 
   3.9403998477985363`*^9, 3.940400604715768*^9, 3.940401128011237*^9, 
   3.9404096731054697`*^9, 3.940409923340283*^9, 3.940409954226672*^9, 
   3.940410509147893*^9, 3.9411744646419353`*^9, 3.9411747071245728`*^9, 
   3.9411856090823708`*^9, 3.9411910966674957`*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"bcf03459-821b-4b32-9b27-ad32c622ba93"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "\[ImaginaryI]", " ", "p0"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"3", "+", 
       SuperscriptBox["p0", "2"]}], ")"}], " ", "x0"}], "+", 
    SuperscriptBox["x0", "3"]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.9393766148009872`*^9, {3.93937842439167*^9, 3.939378453663086*^9}, 
   3.939380859397151*^9, 3.939380953846798*^9, 3.939381420078651*^9, 
   3.939381535048292*^9, 3.9398104504669323`*^9, 3.9398105561335497`*^9, 
   3.939811474985277*^9, 3.939811614237043*^9, {3.9398120549371567`*^9, 
   3.939812078158002*^9}, 3.939812135798045*^9, 3.939812265382793*^9, 
   3.9403998477985363`*^9, 3.940400604715768*^9, 3.940401128011237*^9, 
   3.9404096731054697`*^9, 3.940409923340283*^9, 3.940409954226672*^9, 
   3.940410509147893*^9, 3.9411744646419353`*^9, 3.9411747071245728`*^9, 
   3.9411856090823708`*^9, 3.941191099827935*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"63b1a188-ccf6-4823-92cc-66516a8de656"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Compute", " ", 
    TemplateBox[{
      RowBox[{
        SubscriptBox["\[PartialD]", "x0"], "\[Psi]"}], "\[Psi]"},
     "BraKet"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"d\[Psi]dx0\[Psi]", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", "d\[Psi]dx0", " ", "]"}], 
         RowBox[{"\[Psi]", "[", 
          RowBox[{"x", ",", "xr", ",", "xi", ",", "pr", ",", "pi"}], "]"}]}], 
        "/.", "Rulex0"}], "/.", "Rulep0"}], "//", "ComplexExpand"}], " ", "//",
      "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    TemplateBox[{"dx0\[Psi]", "\[Psi]"},
     "BraKet"], "=", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
     RowBox[{"d\[Psi]dx0\[Psi]", 
      RowBox[{"\[DifferentialD]", "x"}]}]}]}], " ", "\[IndentingNewLine]", 
   RowBox[{
    TemplateBox[{"\[Psi]", "dx0\[Psi]"},
     "BraKet"], " ", "=", " ", 
    RowBox[{
     TemplateBox[{"dx0\[Psi]", "\[Psi]"},
      "BraKet"], "\[Conjugate]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.939377331046871*^9, 3.939377401318954*^9}, {
   3.939380848546329*^9, 3.9393808499206123`*^9}, 3.939381486213327*^9, {
   3.939382004996211*^9, 3.939382017931754*^9}, 3.939810501291695*^9, 
   3.940399711829507*^9, 3.940401086374714*^9},
 CellLabel->"In[22]:=",ExpressionUUID->"3deb22ee-2c91-4bfa-b328-b43a16f7bf1e"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        SuperscriptBox["x", "2"]}], "-", 
       SuperscriptBox["x0", "2"], "+", 
       SuperscriptBox["xi", "2"], "-", 
       SuperscriptBox["xr", "2"], "+", 
       RowBox[{"2", " ", "x", " ", 
        RowBox[{"(", 
         RowBox[{"x0", "+", "xr"}], ")"}]}]}], ")"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "p0"}], "+", 
     RowBox[{"2", " ", "x"}], "+", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "xi"}], "-", 
     RowBox[{"2", " ", "xr"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"xi", " ", 
       RowBox[{"(", 
        RowBox[{"x", "-", "xr"}], ")"}]}], "]"}], "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"xi", " ", 
        RowBox[{"(", 
         RowBox[{"x", "-", "xr"}], ")"}]}], "]"}]}]}], ")"}]}], 
  RowBox[{"2", " ", 
   SqrtBox["\[Pi]"]}]]], "Output",
 CellChangeTimes->{
  3.939377409672039*^9, 3.939380872091696*^9, 3.939381421014485*^9, 
   3.939381536519004*^9, 3.939382019456036*^9, 3.939810453811619*^9, 
   3.93981055703796*^9, 3.9398114758621063`*^9, 3.939811614941931*^9, {
   3.9398120563469763`*^9, 3.939812081535327*^9}, 3.9398121378018084`*^9, 
   3.939812271080271*^9, 3.94039986502491*^9, 3.940400613749898*^9, 
   3.940401140042555*^9, 3.9404096834301643`*^9, 3.940409925901639*^9, 
   3.940409957662096*^9, 3.940410510176496*^9, 3.941174469609481*^9, 
   3.941174708749735*^9, 3.9411856124255047`*^9, 3.941191099919407*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"7d0429d0-f386-4b41-841c-120a182c872a"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "x0"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "xi"}], "+", "xr"}], ")"}], "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[ImaginaryI]", " ", "p0"}], "+", "x0", "+", 
    RowBox[{"3", " ", "\[ImaginaryI]", " ", "xi"}], "-", "xr"}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.939377409672039*^9, 3.939380872091696*^9, 3.939381421014485*^9, 
   3.939381536519004*^9, 3.939382019456036*^9, 3.939810453811619*^9, 
   3.93981055703796*^9, 3.9398114758621063`*^9, 3.939811614941931*^9, {
   3.9398120563469763`*^9, 3.939812081535327*^9}, 3.9398121378018084`*^9, 
   3.939812271080271*^9, 3.94039986502491*^9, 3.940400613749898*^9, 
   3.940401140042555*^9, 3.9404096834301643`*^9, 3.940409925901639*^9, 
   3.940409957662096*^9, 3.940410510176496*^9, 3.941174469609481*^9, 
   3.941174708749735*^9, 3.9411856124255047`*^9, 3.94119111443421*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"8bf5e24f-4093-480a-bc63-762be4337667"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Conjugate", "[", "x0", "]"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Conjugate", "[", "xi", "]"}]}], "+", 
       RowBox[{"Conjugate", "[", "xr", "]"}]}], ")"}], "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     RowBox[{"Conjugate", "[", "p0", "]"}]}], "+", 
    RowBox[{"Conjugate", "[", "x0", "]"}], "-", 
    RowBox[{"3", " ", "\[ImaginaryI]", " ", 
     RowBox[{"Conjugate", "[", "xi", "]"}]}], "-", 
    RowBox[{"Conjugate", "[", "xr", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.939377409672039*^9, 3.939380872091696*^9, 3.939381421014485*^9, 
   3.939381536519004*^9, 3.939382019456036*^9, 3.939810453811619*^9, 
   3.93981055703796*^9, 3.9398114758621063`*^9, 3.939811614941931*^9, {
   3.9398120563469763`*^9, 3.939812081535327*^9}, 3.9398121378018084`*^9, 
   3.939812271080271*^9, 3.94039986502491*^9, 3.940400613749898*^9, 
   3.940401140042555*^9, 3.9404096834301643`*^9, 3.940409925901639*^9, 
   3.940409957662096*^9, 3.940410510176496*^9, 3.941174469609481*^9, 
   3.941174708749735*^9, 3.9411856124255047`*^9, 3.94119111443503*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"504454b0-412f-4635-8ac2-d0b511806aef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Compute", " ", 
    TemplateBox[{
      RowBox[{
        SubscriptBox["\[PartialD]", "p0"], "\[Psi]"}], "\[Psi]"},
     "BraKet"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"d\[Psi]dp0\[Psi]", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", "d\[Psi]dp0", "]"}], 
         RowBox[{"\[Psi]", "[", 
          RowBox[{"x", ",", "xr", ",", "xi", ",", "pr", ",", "pi"}], "]"}]}], 
        "/.", "Rulex0"}], "/.", "Rulep0"}], "//", "ComplexExpand"}], " ", "//",
      "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    TemplateBox[{"dp0\[Psi]", "\[Psi]"},
     "BraKet"], "=", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
     RowBox[{"d\[Psi]dp0\[Psi]", 
      RowBox[{"\[DifferentialD]", "x"}]}]}]}], " ", "\[IndentingNewLine]", 
   RowBox[{
    TemplateBox[{"\[Psi]", "dp0\[Psi]"},
     "BraKet"], " ", "=", " ", 
    RowBox[{
     TemplateBox[{"dp0\[Psi]", "\[Psi]"},
      "BraKet"], "\[Conjugate]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9393773778653717`*^9, 3.939377381830948*^9}, {
   3.939377467226091*^9, 3.939377470503458*^9}, {3.939380837154984*^9, 
   3.939380839008144*^9}, 3.939381525333737*^9, {3.93938203619654*^9, 
   3.939382047363744*^9}, {3.939810512971611*^9, 3.939810514680118*^9}, 
   3.940399715013009*^9, 3.9404010889992933`*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"9ea277c0-8d96-439e-a9b7-6ee7d0721ac2"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        SuperscriptBox["x", "2"]}], "-", 
       SuperscriptBox["x0", "2"], "+", 
       SuperscriptBox["xi", "2"], "-", 
       SuperscriptBox["xr", "2"], "+", 
       RowBox[{"2", " ", "x", " ", 
        RowBox[{"(", 
         RowBox[{"x0", "+", "xr"}], ")"}]}]}], ")"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "x"}], "-", "x0"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"xi", " ", 
        RowBox[{"(", 
         RowBox[{"x", "-", "xr"}], ")"}]}], "]"}]}], "+", 
     RowBox[{"Sin", "[", 
      RowBox[{"xi", " ", 
       RowBox[{"(", 
        RowBox[{"x", "-", "xr"}], ")"}]}], "]"}]}], ")"}]}], 
  RowBox[{"2", " ", 
   SqrtBox["\[Pi]"]}]]], "Output",
 CellChangeTimes->{
  3.9393774716568832`*^9, 3.939380840294537*^9, 3.939381421718759*^9, 
   3.939381537469729*^9, 3.9393820559580383`*^9, 3.939810455039927*^9, 
   3.9398105577195063`*^9, 3.939811476837235*^9, 3.939811615665875*^9, {
   3.939812056726656*^9, 3.939812082151949*^9}, 3.9398121387374077`*^9, 
   3.939812271715157*^9, 3.940399866970179*^9, 3.940400614939749*^9, 
   3.9404011531701727`*^9, 3.9404096941838303`*^9, 3.9404099291659803`*^9, 
   3.940409960289987*^9, 3.940410512151153*^9, 3.941174484374146*^9, 
   3.941174711984289*^9, 3.941185628838972*^9, 3.941191114506331*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"412ffa3e-dd2a-4c07-aee6-30ff207b6a34"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "x0"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "xi"}], "+", "xr"}], ")"}], "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{"xi", "-", 
    RowBox[{"\[ImaginaryI]", " ", "xr"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.9393774716568832`*^9, 3.939380840294537*^9, 3.939381421718759*^9, 
   3.939381537469729*^9, 3.9393820559580383`*^9, 3.939810455039927*^9, 
   3.9398105577195063`*^9, 3.939811476837235*^9, 3.939811615665875*^9, {
   3.939812056726656*^9, 3.939812082151949*^9}, 3.9398121387374077`*^9, 
   3.939812271715157*^9, 3.940399866970179*^9, 3.940400614939749*^9, 
   3.9404011531701727`*^9, 3.9404096941838303`*^9, 3.9404099291659803`*^9, 
   3.940409960289987*^9, 3.940410512151153*^9, 3.941174484374146*^9, 
   3.941174711984289*^9, 3.941185628838972*^9, 3.94119112361189*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"27750fe2-f3ee-42c1-9471-7df41eedc694"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Conjugate", "[", "x0", "]"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Conjugate", "[", "xi", "]"}]}], "+", 
       RowBox[{"Conjugate", "[", "xr", "]"}]}], ")"}], "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Conjugate", "[", "xi", "]"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Conjugate", "[", "xr", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.9393774716568832`*^9, 3.939380840294537*^9, 3.939381421718759*^9, 
   3.939381537469729*^9, 3.9393820559580383`*^9, 3.939810455039927*^9, 
   3.9398105577195063`*^9, 3.939811476837235*^9, 3.939811615665875*^9, {
   3.939812056726656*^9, 3.939812082151949*^9}, 3.9398121387374077`*^9, 
   3.939812271715157*^9, 3.940399866970179*^9, 3.940400614939749*^9, 
   3.9404011531701727`*^9, 3.9404096941838303`*^9, 3.9404099291659803`*^9, 
   3.940409960289987*^9, 3.940410512151153*^9, 3.941174484374146*^9, 
   3.941174711984289*^9, 3.941185628838972*^9, 3.9411911236126328`*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"ab9ead74-c93c-4533-a268-c7aefca018d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Compute", " ", 
    TemplateBox[{
      RowBox[{
        SubscriptBox["\[PartialD]", "x0"], "\[Psi]"}], 
      RowBox[{
        SubscriptBox["\[PartialD]", "x0"], "\[Psi]"}]},
     "BraKet"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"d\[Psi]dx0d\[Psi]dx0", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", "d\[Psi]dx0", " ", "]"}], "d\[Psi]dx0"}], "/.",
         "Rulex0"}], "/.", "Rulep0"}], "//", "ComplexExpand"}], " ", "//", 
     "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    TemplateBox[{"dx0\[Psi]", "dx0\[Psi]"},
     "BraKet"], "=", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
     RowBox[{"d\[Psi]dx0d\[Psi]dx0", 
      RowBox[{"\[DifferentialD]", "x", " "}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.939377491562166*^9, 3.939377550984321*^9}, {
   3.939381013475182*^9, 3.939381018431789*^9}, {3.9393814894129953`*^9, 
   3.939381520289761*^9}, {3.9398105207477903`*^9, 3.939810529865782*^9}, 
   3.9404010914157887`*^9},
 CellLabel->"In[28]:=",ExpressionUUID->"4aa16728-6e55-47c6-927a-181585c5e93d"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", "-", "x0"}], ")"}], "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["p0", "2"], "+", 
     RowBox[{"4", " ", "p0", " ", "xi"}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["xi", "2"], "-", 
        RowBox[{"2", " ", "x", " ", "xr"}], "+", 
        SuperscriptBox["xr", "2"]}], ")"}]}]}], ")"}]}], 
  RowBox[{"4", " ", 
   SqrtBox["\[Pi]"]}]]], "Output",
 CellChangeTimes->{
  3.9393775524165277`*^9, 3.93938142279802*^9, 3.939381538324136*^9, 
   3.939810456415309*^9, 3.9398105588287497`*^9, 3.939811478040413*^9, 
   3.939811616942665*^9, {3.939812057742433*^9, 3.9398120830088987`*^9}, 
   3.939812139922659*^9, 3.939812272471599*^9, 3.940399868715795*^9, 
   3.940400616279643*^9, 3.9404011598999653`*^9, 3.940409700367968*^9, 
   3.940409930974625*^9, 3.940409962075921*^9, 3.940410513695422*^9, 
   3.941174492368745*^9, 3.941174713965157*^9, 3.941185636439102*^9, 
   3.941191123763829*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"5565932f-0e86-4fe7-9f8c-78bd7b2e7b68"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{"2", "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"p0", "+", 
       RowBox[{"2", " ", "xi"}]}], ")"}], "2"], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x0", "-", "xr"}], ")"}], "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.9393775524165277`*^9, 3.93938142279802*^9, 3.939381538324136*^9, 
   3.939810456415309*^9, 3.9398105588287497`*^9, 3.939811478040413*^9, 
   3.939811616942665*^9, {3.939812057742433*^9, 3.9398120830088987`*^9}, 
   3.939812139922659*^9, 3.939812272471599*^9, 3.940399868715795*^9, 
   3.940400616279643*^9, 3.9404011598999653`*^9, 3.940409700367968*^9, 
   3.940409930974625*^9, 3.940409962075921*^9, 3.940410513695422*^9, 
   3.941174492368745*^9, 3.941174713965157*^9, 3.941185636439102*^9, 
   3.941191125610119*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"bdf88048-fb89-47b1-a096-3ad70ebcd5d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Compute", " ", 
    TemplateBox[{
      RowBox[{
        SubscriptBox["\[PartialD]", "p0"], "\[Psi]"}], 
      RowBox[{
        SubscriptBox["\[PartialD]", "p0"], "\[Psi]"}]},
     "BraKet"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"d\[Psi]dp0d\[Psi]dp0", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", "d\[Psi]dp0", " ", "]"}], "d\[Psi]dp0"}], "/.",
         "Rulex0"}], "/.", "Rulep0"}], "//", "ComplexExpand"}], " ", "//", 
     "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    TemplateBox[{"dp0\[Psi]", "dp0\[Psi]"},
     "BraKet"], "=", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
     RowBox[{"d\[Psi]dp0d\[Psi]dp0", 
      RowBox[{"\[DifferentialD]", "x", " "}]}]}]}]}]}]], "Input",
 CellChangeTimes->{
  3.9393775088737097`*^9, {3.939377572296534*^9, 3.939377582921282*^9}, {
   3.939381023555086*^9, 3.939381024320372*^9}, {3.939381514565137*^9, 
   3.939381516130457*^9}, {3.939810533675846*^9, 3.93981054178376*^9}, 
   3.940401093622644*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"f041cf36-f989-40c3-983f-78e4ce978532"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", "-", "x0"}], ")"}], "2"]}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "x"}], "+", "x0"}], ")"}], "2"]}], 
  RowBox[{"4", " ", 
   SqrtBox["\[Pi]"]}]]], "Output",
 CellChangeTimes->{
  3.939377584509099*^9, 3.939381423345481*^9, 3.939381539024847*^9, 
   3.939810457089025*^9, 3.939810560074333*^9, 3.939811478556665*^9, 
   3.939811617416089*^9, {3.939812058357889*^9, 3.939812083660754*^9}, 
   3.939812140837078*^9, 3.939812273425791*^9, 3.940399874175961*^9, 
   3.940400618244341*^9, 3.940401163519237*^9, 3.940409703593443*^9, 
   3.940409931934203*^9, 3.9404099629342012`*^9, 3.9404105144948473`*^9, 
   3.941174494638947*^9, 3.941174715098837*^9, 3.941185637552805*^9, 
   3.9411911256625957`*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"34c4afe8-e461-4ce0-b920-3db219a16e17"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{"2", "+", 
    SuperscriptBox["x0", "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.939377584509099*^9, 3.939381423345481*^9, 3.939381539024847*^9, 
   3.939810457089025*^9, 3.939810560074333*^9, 3.939811478556665*^9, 
   3.939811617416089*^9, {3.939812058357889*^9, 3.939812083660754*^9}, 
   3.939812140837078*^9, 3.939812273425791*^9, 3.940399874175961*^9, 
   3.940400618244341*^9, 3.940401163519237*^9, 3.940409703593443*^9, 
   3.940409931934203*^9, 3.9404099629342012`*^9, 3.9404105144948473`*^9, 
   3.941174494638947*^9, 3.941174715098837*^9, 3.941185637552805*^9, 
   3.9411911267261257`*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"145d34ef-7c62-4e16-bdec-bdafc3cb1e34"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Compute", " ", 
    TemplateBox[{
      RowBox[{
        SubscriptBox["\[PartialD]", "x0"], "\[Psi]"}], 
      RowBox[{
        SubscriptBox["\[PartialD]", "p0"], "\[Psi]"}]},
     "BraKet"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"d\[Psi]dx0d\[Psi]dp0", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", "d\[Psi]dx0", " ", "]"}], "d\[Psi]dp0"}], "/.",
         "Rulex0"}], "/.", "Rulep0"}], "//", "ComplexExpand"}], " ", "//", 
     "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    TemplateBox[{"dx0\[Psi]", "dp0\[Psi]"},
     "BraKet"], "=", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
     RowBox[{"d\[Psi]dx0d\[Psi]dp0", 
      RowBox[{"\[DifferentialD]", "x"}]}]}]}], " ", "\[IndentingNewLine]", 
   RowBox[{
    TemplateBox[{"dp0\[Psi]", "dx0\[Psi]"},
     "BraKet"], " ", "=", " ", 
    RowBox[{
     TemplateBox[{"dx0\[Psi]", "dp0\[Psi]"},
      "BraKet"], "\[Conjugate]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9393775256073427`*^9, 3.9393775257191257`*^9}, {
   3.939377727785535*^9, 3.939377744792296*^9}, {3.939381033107288*^9, 
   3.939381034368341*^9}, {3.939381493588935*^9, 3.939381511507536*^9}, {
   3.939382066147771*^9, 3.939382073253538*^9}, {3.939810546988071*^9, 
   3.939810550824637*^9}, 3.940401095158901*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"98445d77-d8a8-4c14-b50c-2ce3017e5b21"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", "-", "x0"}], ")"}], "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "x"}], "-", "x0"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "p0"}], "+", 
     RowBox[{"2", " ", "x"}], "+", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "xi"}], "-", 
     RowBox[{"2", " ", "xr"}]}], ")"}]}], 
  RowBox[{"4", " ", 
   SqrtBox["\[Pi]"]}]]], "Output",
 CellChangeTimes->{3.939377746206128*^9, 3.939381037309518*^9, 
  3.939381423676052*^9, 3.939381539488345*^9, 3.9393820760148*^9, 
  3.9398104578360853`*^9, 3.939810561051818*^9, 3.9398114790940533`*^9, 
  3.939811618342627*^9, 3.939812058813274*^9, 3.939812141158928*^9, 
  3.939812273762376*^9, 3.940399875794668*^9, 3.940400619342239*^9, 
  3.940401163972866*^9, 3.940409704010416*^9, 3.940409932460415*^9, 
  3.940409963268785*^9, 3.940410514969035*^9, 3.9411744955214033`*^9, 
  3.94117471552841*^9, 3.94118563793998*^9, 3.941191126794826*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"053a4ee3-aa78-41e0-92f8-1c8393364eec"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "p0"}], " ", "x0"}], "+", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"x0", " ", 
        RowBox[{"(", 
         RowBox[{"x0", "+", 
          RowBox[{"\[ImaginaryI]", " ", "xi"}], "-", "xr"}], ")"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.939377746206128*^9, 3.939381037309518*^9, 
  3.939381423676052*^9, 3.939381539488345*^9, 3.9393820760148*^9, 
  3.9398104578360853`*^9, 3.939810561051818*^9, 3.9398114790940533`*^9, 
  3.939811618342627*^9, 3.939812058813274*^9, 3.939812141158928*^9, 
  3.939812273762376*^9, 3.940399875794668*^9, 3.940400619342239*^9, 
  3.940401163972866*^9, 3.940409704010416*^9, 3.940409932460415*^9, 
  3.940409963268785*^9, 3.940410514969035*^9, 3.9411744955214033`*^9, 
  3.94117471552841*^9, 3.94118563793998*^9, 3.941191128651587*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"945c4a94-1b17-4e20-a0da-288ed2f469d8"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"Conjugate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "p0"}], " ", "x0"}], "+", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"x0", " ", 
        RowBox[{"(", 
         RowBox[{"x0", "+", 
          RowBox[{"\[ImaginaryI]", " ", "xi"}], "-", "xr"}], ")"}]}]}], 
      ")"}]}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.939377746206128*^9, 3.939381037309518*^9, 
  3.939381423676052*^9, 3.939381539488345*^9, 3.9393820760148*^9, 
  3.9398104578360853`*^9, 3.939810561051818*^9, 3.9398114790940533`*^9, 
  3.939811618342627*^9, 3.939812058813274*^9, 3.939812141158928*^9, 
  3.939812273762376*^9, 3.940399875794668*^9, 3.940400619342239*^9, 
  3.940401163972866*^9, 3.940409704010416*^9, 3.940409932460415*^9, 
  3.940409963268785*^9, 3.940410514969035*^9, 3.9411744955214033`*^9, 
  3.94117471552841*^9, 3.94118563793998*^9, 3.941191128652835*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"ba52efd1-c474-4d94-960a-81882c3873f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Compute", " ", "Forces"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Fx0", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         TemplateBox[{"dx0\[Psi]", "H\[Psi]"},
          "BraKet"], "/", 
         TemplateBox[{"\[Psi]", "\[Psi]"},
          "BraKet"]}], "-", 
        RowBox[{
         TemplateBox[{"dx0\[Psi]", "\[Psi]"},
          "BraKet"], 
         RowBox[{
          RowBox[{
           TemplateBox[{"\[Psi]", "H\[Psi]"},
            "BraKet"], " ", "/", 
           TemplateBox[{"\[Psi]", "\[Psi]"},
            "BraKet"]}], "/", 
          TemplateBox[{"\[Psi]", "\[Psi]"},
           "BraKet"]}]}]}], "/.", "Rulex0"}], "/.", "Rulep0"}], "//", " ", 
     "FullSimplify"}]}], "\[IndentingNewLine]", 
   RowBox[{"Fp0", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         TemplateBox[{"dp0\[Psi]", "H\[Psi]"},
          "BraKet"], "/", 
         TemplateBox[{"\[Psi]", "\[Psi]"},
          "BraKet"]}], "-", 
        RowBox[{
         TemplateBox[{"dp0\[Psi]", "\[Psi]"},
          "BraKet"], 
         RowBox[{
          RowBox[{
           TemplateBox[{"\[Psi]", "H\[Psi]"},
            "BraKet"], "/", 
           TemplateBox[{"\[Psi]", "\[Psi]"},
            "BraKet"]}], "/", 
          TemplateBox[{"\[Psi]", "\[Psi]"},
           "BraKet"]}]}]}], " ", "/.", "Rulex0"}], "/.", "Rulep0"}], "//", 
     " ", "FullSimplify"}]}]}]}]], "Input",
 CellChangeTimes->{{3.939381068466648*^9, 3.939381162593356*^9}, {
   3.939381204866041*^9, 3.939381211217297*^9}, {3.939381548373372*^9, 
   3.939381585939674*^9}, {3.939813046641007*^9, 3.939813053295556*^9}, 
   3.940399741493403*^9, {3.9404010967760887`*^9, 3.9404010975432777`*^9}, {
   3.941174387570031*^9, 3.941174405299219*^9}, {3.9411747614427843`*^9, 
   3.941174794709168*^9}, {3.941186258386527*^9, 3.941186265613144*^9}, 
   3.941186453901568*^9, {3.9411864888540382`*^9, 3.941186534892503*^9}, {
   3.9411868755238123`*^9, 3.941186979568264*^9}, {3.941187290180366*^9, 
   3.94118729086213*^9}, {3.941187334849111*^9, 3.94118733676757*^9}, {
   3.941187834843961*^9, 3.9411878716303177`*^9}, {3.941187910722136*^9, 
   3.941188001584597*^9}, {3.941188062626019*^9, 3.941188116032248*^9}, {
   3.9411881583055983`*^9, 3.9411882861642437`*^9}, {3.9411885697807493`*^9, 
   3.941188579648748*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"913bcab5-fe90-4b0b-9a21-cf3068310aa6"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "2"}], " ", 
    SuperscriptBox["xi", "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      SuperscriptBox["xi", "2"]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["p0", "3"]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "p0", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          SuperscriptBox["x0", "2"]}], ")"}]}], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "xi"}], "+", 
       RowBox[{"2", " ", "x0", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"x0", " ", 
           RowBox[{"(", 
            RowBox[{"x0", "+", 
             RowBox[{"\[ImaginaryI]", " ", "xi"}], "-", "xr"}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["p0", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"x0", "+", 
          RowBox[{"\[ImaginaryI]", " ", "xi"}], "-", "xr"}], ")"}]}], "-", 
       RowBox[{"2", " ", "xr"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x0", "+", 
          RowBox[{"\[ImaginaryI]", " ", "xi"}], "-", "xr"}], ")"}], "2"]}]], 
     " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p0", "-", 
          RowBox[{"\[ImaginaryI]", " ", "x0"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"p0", "+", "xi", "+", 
          RowBox[{"\[ImaginaryI]", " ", "xr"}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "p0"}], "-", "x0", "-", 
       RowBox[{"3", " ", "\[ImaginaryI]", " ", "xi"}], "+", "xr"}], ")"}]}]}],
    ")"}]}]], "Output",
 CellChangeTimes->{
  3.941186387699226*^9, 3.941186459748176*^9, {3.9411864907432423`*^9, 
   3.941186498107273*^9}, 3.941186541151091*^9, {3.941186901292437*^9, 
   3.941186980969687*^9}, 3.941187292359565*^9, 3.941187360909676*^9, {
   3.94118784924402*^9, 3.941187872874449*^9}, {3.941187914204042*^9, 
   3.9411879225866137`*^9}, 3.9411879527450523`*^9, {3.941188109515771*^9, 
   3.941188118568063*^9}, {3.941188167882482*^9, 3.941188287448359*^9}, {
   3.941188573530115*^9, 3.94118858044462*^9}, 3.941191129155678*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"d192cd52-f63e-46f1-b575-9bda2ed05cec"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "2"}], " ", 
    SuperscriptBox["xi", "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     SuperscriptBox["\[ExponentialE]", 
      SuperscriptBox["xi", "2"]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "p0"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3", "+", 
          SuperscriptBox["p0", "2"]}], ")"}], " ", "x0"}], "+", 
       SuperscriptBox["x0", "3"]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x0", "+", 
          RowBox[{"\[ImaginaryI]", " ", "xi"}], "-", "xr"}], ")"}], "2"]}]], 
     " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p0", "-", 
          RowBox[{"\[ImaginaryI]", " ", "x0"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"p0", "+", "xi", "+", 
          RowBox[{"\[ImaginaryI]", " ", "xr"}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"xi", "-", 
       RowBox[{"\[ImaginaryI]", " ", "xr"}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.941186387699226*^9, 3.941186459748176*^9, {3.9411864907432423`*^9, 
   3.941186498107273*^9}, 3.941186541151091*^9, {3.941186901292437*^9, 
   3.941186980969687*^9}, 3.941187292359565*^9, 3.941187360909676*^9, {
   3.94118784924402*^9, 3.941187872874449*^9}, {3.941187914204042*^9, 
   3.9411879225866137`*^9}, 3.9411879527450523`*^9, {3.941188109515771*^9, 
   3.941188118568063*^9}, {3.941188167882482*^9, 3.941188287448359*^9}, {
   3.941188573530115*^9, 3.94118858044462*^9}, 3.941191129267758*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"aa909370-15e0-4b92-a9bc-7433ac31d251"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Compute", " ", "Quantum", " ", "Geometric", " ", "Tensor"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Sx0x0", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          TemplateBox[{"dx0\[Psi]", "dx0\[Psi]"},
           "BraKet"], "/", 
          TemplateBox[{"\[Psi]", "\[Psi]"},
           "BraKet"]}], "-", 
         RowBox[{
          TemplateBox[{"dx0\[Psi]", "\[Psi]"},
           "BraKet"], 
          RowBox[{
           RowBox[{
            TemplateBox[{"\[Psi]", "dx0\[Psi]"},
             "BraKet"], "/", 
            TemplateBox[{"\[Psi]", "\[Psi]"},
             "BraKet"]}], "/", 
           TemplateBox[{"\[Psi]", "\[Psi]"},
            "BraKet"]}]}]}], "/.", "Rulex0"}], "/.", "Rulep0"}], "//", 
      "ComplexExpand"}], " ", "//", 
     RowBox[{
      RowBox[{"FullSimplify", "/.", "Rulex0"}], "/.", "Rulep0"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Sx0p0", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          TemplateBox[{"dx0\[Psi]", "dp0\[Psi]"},
           "BraKet"], "/", 
          TemplateBox[{"\[Psi]", "\[Psi]"},
           "BraKet"]}], "-", 
         RowBox[{
          TemplateBox[{"dx0\[Psi]", "\[Psi]"},
           "BraKet"], 
          RowBox[{
           RowBox[{
            TemplateBox[{"\[Psi]", "dp0\[Psi]"},
             "BraKet"], "/", 
            TemplateBox[{"\[Psi]", "\[Psi]"},
             "BraKet"]}], "/", 
           TemplateBox[{"\[Psi]", "\[Psi]"},
            "BraKet"]}]}]}], "/.", "Rulex0"}], "/.", "Rulep0"}], "//", 
      "ComplexExpand"}], " ", "//", 
     RowBox[{
      RowBox[{"FullSimplify", "/.", "Rulex0"}], "/.", "Rulep0"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Sp0x0", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          TemplateBox[{"dp0\[Psi]", "dx0\[Psi]"},
           "BraKet"], "/", 
          TemplateBox[{"\[Psi]", "\[Psi]"},
           "BraKet"]}], "-", 
         RowBox[{
          TemplateBox[{"dp0\[Psi]", "\[Psi]"},
           "BraKet"], 
          RowBox[{
           RowBox[{
            TemplateBox[{"\[Psi]", "dx0\[Psi]"},
             "BraKet"], "/", 
            TemplateBox[{"\[Psi]", "\[Psi]"},
             "BraKet"]}], "/", 
           TemplateBox[{"\[Psi]", "\[Psi]"},
            "BraKet"]}]}]}], "/.", "Rulex0"}], "/.", "Rulep0"}], "//", 
      "ComplexExpand"}], " ", "//", 
     RowBox[{
      RowBox[{"FullSimplify", "/.", "Rulex0"}], "/.", "Rulep0"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Sp0p0", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          TemplateBox[{"dp0\[Psi]", "dp0\[Psi]"},
           "BraKet"], "/", 
          TemplateBox[{"\[Psi]", "\[Psi]"},
           "BraKet"]}], "-", 
         RowBox[{
          TemplateBox[{"dp0\[Psi]", "\[Psi]"},
           "BraKet"], 
          RowBox[{
           RowBox[{
            TemplateBox[{"\[Psi]", "dp0\[Psi]"},
             "BraKet"], "/", 
            TemplateBox[{"\[Psi]", "\[Psi]"},
             "BraKet"]}], "/", 
           TemplateBox[{"\[Psi]", "\[Psi]"},
            "BraKet"]}]}]}], "/.", "Rulex0"}], "/.", "Rulep0"}], "//", 
      "ComplexExpand"}], " ", "//", 
     RowBox[{
      RowBox[{"FullSimplify", "/.", "Rulex0"}], "/.", 
      "Rulep0"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.939381829075864*^9, 3.939381879147793*^9}, {
  3.939381916242569*^9, 3.9393819735393057`*^9}, {3.9393820989000797`*^9, 
  3.939382172596673*^9}, {3.939813332016819*^9, 3.9398133444683867`*^9}, {
  3.9403997345648518`*^9, 3.940399735987862*^9}, {3.940401100200705*^9, 
  3.940401102054665*^9}, {3.940401201836032*^9, 3.940401203895669*^9}, {
  3.941174421091775*^9, 3.941174446899457*^9}, {3.9411893575671463`*^9, 
  3.941189358142448*^9}, {3.941189625412364*^9, 3.94118962998975*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"42487863-57db-4326-80a7-f08741610eab"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "4"]}], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "7"}], " ", 
        SuperscriptBox["xi", "2"]}], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x0", "-", "xr"}], ")"}], "2"], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "xi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x0"}], "+", "xr"}], ")"}]}]}], ")"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"p0", "+", 
        RowBox[{"3", " ", "xi"}]}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x0", "-", "xr"}], ")"}], "2"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     SuperscriptBox["xi", "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{"2", "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"p0", "+", 
        RowBox[{"2", " ", "xi"}]}], ")"}], "2"], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x0", "-", "xr"}], ")"}], "2"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.9393821574158907`*^9, 3.939382174074987*^9}, 
   3.939810459141974*^9, 3.939810561501243*^9, 3.939811479539562*^9, 
   3.9398116191696997`*^9, 3.939812059387438*^9, 3.939812141998114*^9, 
   3.9398122742450027`*^9, 3.939813346517187*^9, 3.940399880671792*^9, 
   3.9404006225690727`*^9, 3.940401165684208*^9, 3.940401205035715*^9, 
   3.940409705271624*^9, 3.9404099337367373`*^9, 3.940409964866132*^9, 
   3.9404105163467007`*^9, 3.941174627308984*^9, 3.941174717288011*^9, 
   3.941185639640551*^9, 3.941189553950789*^9, 3.9411896328088703`*^9, 
   3.94119113048319*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"3455495d-f3e7-4b42-ab7d-385474f89f87"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     SuperscriptBox["xi", "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "p0"}], " ", "x0"}], "+", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"x0", " ", 
         RowBox[{"(", 
          RowBox[{"x0", "+", 
           RowBox[{"\[ImaginaryI]", " ", "xi"}], "-", "xr"}], ")"}]}]}], 
       ")"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "7"}], " ", 
        SuperscriptBox["xi", "2"]}], "-", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "xi", " ", 
        RowBox[{"(", 
         RowBox[{"x0", "-", "xr"}], ")"}]}], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x0", "-", "xr"}], ")"}], "2"]}], ")"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{"p0", "-", 
     RowBox[{"\[ImaginaryI]", " ", "x0"}], "+", 
     RowBox[{"3", " ", "xi"}], "+", 
     RowBox[{"\[ImaginaryI]", " ", "xr"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "xi"}], "+", "xr"}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.9393821574158907`*^9, 3.939382174074987*^9}, 
   3.939810459141974*^9, 3.939810561501243*^9, 3.939811479539562*^9, 
   3.9398116191696997`*^9, 3.939812059387438*^9, 3.939812141998114*^9, 
   3.9398122742450027`*^9, 3.939813346517187*^9, 3.940399880671792*^9, 
   3.9404006225690727`*^9, 3.940401165684208*^9, 3.940401205035715*^9, 
   3.940409705271624*^9, 3.9404099337367373`*^9, 3.940409964866132*^9, 
   3.9404105163467007`*^9, 3.941174627308984*^9, 3.941174717288011*^9, 
   3.941185639640551*^9, 3.941189553950789*^9, 3.9411896328088703`*^9, 
   3.941191131767364*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"466a77be-7f1b-4c10-835d-c93bf13f09ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "4"]}], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     SuperscriptBox["xi", "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "\[ImaginaryI]"}], "+", 
     RowBox[{"x0", " ", 
      RowBox[{"(", 
       RowBox[{"p0", "+", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "x0"}], "+", 
        RowBox[{"2", " ", "xi"}], "-", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "xr"}]}], ")"}]}]}], ")"}]}], 
  "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "7"}], " ", 
        SuperscriptBox["xi", "2"]}], "-", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "xi", " ", 
        RowBox[{"(", 
         RowBox[{"x0", "-", "xr"}], ")"}]}], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x0", "-", "xr"}], ")"}], "2"]}], ")"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{"p0", "+", 
     RowBox[{"\[ImaginaryI]", " ", "x0"}], "+", 
     RowBox[{"3", " ", "xi"}], "-", 
     RowBox[{"\[ImaginaryI]", " ", "xr"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "xi"}], "+", "xr"}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.9393821574158907`*^9, 3.939382174074987*^9}, 
   3.939810459141974*^9, 3.939810561501243*^9, 3.939811479539562*^9, 
   3.9398116191696997`*^9, 3.939812059387438*^9, 3.939812141998114*^9, 
   3.9398122742450027`*^9, 3.939813346517187*^9, 3.940399880671792*^9, 
   3.9404006225690727`*^9, 3.940401165684208*^9, 3.940401205035715*^9, 
   3.940409705271624*^9, 3.9404099337367373`*^9, 3.940409964866132*^9, 
   3.9404105163467007`*^9, 3.941174627308984*^9, 3.941174717288011*^9, 
   3.941185639640551*^9, 3.941189553950789*^9, 3.9411896328088703`*^9, 
   3.941191133012212*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"3054c152-cc67-4636-b55f-e0ca7c936992"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     SuperscriptBox["xi", "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{"2", "+", 
     SuperscriptBox["x0", "2"]}], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "7"}], " ", 
        SuperscriptBox["xi", "2"]}], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x0", "-", "xr"}], ")"}], "2"], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "xi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x0"}], "+", "xr"}], ")"}]}]}], ")"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["xi", "2"], "+", 
     SuperscriptBox["xr", "2"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.9393821574158907`*^9, 3.939382174074987*^9}, 
   3.939810459141974*^9, 3.939810561501243*^9, 3.939811479539562*^9, 
   3.9398116191696997`*^9, 3.939812059387438*^9, 3.939812141998114*^9, 
   3.9398122742450027`*^9, 3.939813346517187*^9, 3.940399880671792*^9, 
   3.9404006225690727`*^9, 3.940401165684208*^9, 3.940401205035715*^9, 
   3.940409705271624*^9, 3.9404099337367373`*^9, 3.940409964866132*^9, 
   3.9404105163467007`*^9, 3.941174627308984*^9, 3.941174717288011*^9, 
   3.941185639640551*^9, 3.941189553950789*^9, 3.9411896328088703`*^9, 
   3.941191133789958*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"b644a292-5c87-4bac-af3c-8ece951d4172"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Define", " ", "the", " ", "matrix", " ", "S", " ", "and", " ", "vector", 
     " ", "F", " ", "using", " ", "your", " ", "predefined", " ", 
     "elements"}], ",", 
    RowBox[{"e", ".", "g", "."}], ",", "s11", ",", "s12", ",", 
    RowBox[{"etc", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Sx0x0", ",", "Sx0p0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Sp0x0", ",", "Sp0p0"}], "}"}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"F", "=", 
     RowBox[{"{", 
      RowBox[{"Fx0", ",", "Fp0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Calculate", " ", "the", " ", "determinant", " ", "of", " ", "S"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"detS", "=", 
    RowBox[{
     RowBox[{"Det", "[", "S", "]"}], "//", "FullSimplify"}]}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Solve", " ", "for", " ", "x", " ", "based", " ", "on", " ", "whether", 
     " ", "S", " ", "is", " ", "singular", " ", "or", " ", "not"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xSolution", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"detS", "\[NotEqual]", "0"}], ",", 
       RowBox[{
        RowBox[{"Inverse", "[", "S", "]"}], ".", "F"}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Standard", " ", "inversion", " ", "when", " ", "det", 
          RowBox[{"(", "S", ")"}]}], "\[NotEqual]", "0"}], "*)"}], 
       RowBox[{
        RowBox[{"PseudoInverse", "[", "S", "]"}], ".", "F"}]}], " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"Use", " ", "pseudo"}], "-", 
         RowBox[{"inverse", " ", "when", " ", "det", 
          RowBox[{"(", "S", ")"}]}]}], "=", "0"}], "*)"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"xSolution", "//", "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.9393829744560013`*^9, 3.939383004085363*^9}, {
   3.939383249963416*^9, 3.939383258343692*^9}, 3.940399746964135*^9, {
   3.9411874019176483`*^9, 3.9411874377384253`*^9}, {3.9411888411058397`*^9, 
   3.941188846930304*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"aa579d6e-dcf9-4e1b-968a-260a4a8bac83"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "16"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"11", " ", 
       SuperscriptBox["xi", "2"]}], "4"]}], "-", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x0", "-", "xr"}], ")"}], "2"]}]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          SuperscriptBox["xi", "2"]}], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x0", "-", "xr"}], ")"}], "2"]}], ")"}]}]]}], "-", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "xi", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "x0"}], "+", "xr"}], ")"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       SuperscriptBox["xi", "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x0", "-", "xr"}], ")"}], "2"]}], ")"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"p0", "+", 
       RowBox[{"2", " ", "xi"}]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x0", "-", 
       RowBox[{"2", " ", "xr"}]}], ")"}], "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.941188812673346*^9, 3.941188850004993*^9, 
  3.941191135298666*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"43c584e1-07d4-49e3-917f-9603e245f765"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"\[ImaginaryI]", "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["p0", "2"]}], "+", 
     RowBox[{"p0", " ", "x0"}]}], 
    RowBox[{"p0", "+", 
     RowBox[{"\[ImaginaryI]", " ", "x0"}], "+", 
     RowBox[{"2", " ", "xi"}], "-", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "xr"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["x0", "2"], "-", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "x0", " ", "xi"}], "+", 
     RowBox[{"p0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "x0"}], "+", 
        RowBox[{"2", " ", "xi"}], "-", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "xr"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "x0", " ", "xr"}]}], 
    RowBox[{"p0", "+", 
     RowBox[{"\[ImaginaryI]", " ", "x0"}], "+", 
     RowBox[{"2", " ", "xi"}], "-", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "xr"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.941188812673346*^9, 3.941188850004993*^9, 
  3.941191143441762*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"31636b1c-f3c2-40ce-80b5-8e462bc8b193"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Inverse", "[", "S", "]"}], ".", "F"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.941188884016189*^9, 3.941188886113123*^9}, {
   3.941188935617741*^9, 3.941188937056431*^9}, {3.9411892662906437`*^9, 
   3.9411892823539753`*^9}, 3.941189610869989*^9, {3.941190262896607*^9, 
   3.941190303045747*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"2de665cd-f889-4ddd-ab61-aed06cadc605"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["p0", "2"]}], ")"}]}], "+", 
     RowBox[{"p0", " ", "x0"}]}], 
    RowBox[{"p0", "+", 
     RowBox[{"\[ImaginaryI]", " ", "x0"}], "+", 
     RowBox[{"2", " ", "xi"}], "-", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "xr"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "p0"}], "+", "x0"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"x0", "-", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "xi"}], "-", 
        RowBox[{"2", " ", "xr"}]}], ")"}]}]}], 
    RowBox[{"p0", "+", 
     RowBox[{"\[ImaginaryI]", " ", "x0"}], "+", 
     RowBox[{"2", " ", "xi"}], "-", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "xr"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.9411902671906767`*^9, 3.941190305845565*^9}, 
   3.9411911441932783`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"d187f957-dbe1-4444-b1ec-980e23213b03"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PseudoInverse", "[", "S", "]"}], ".", "F"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.941188943472438*^9, 3.941188944320095*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"5968b8c9-8ab5-4b2f-a2ee-6d9171e65ce2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["p0", "2"]}], ")"}]}], "+", 
     RowBox[{"p0", " ", "x0"}]}], 
    RowBox[{"p0", "+", 
     RowBox[{"\[ImaginaryI]", " ", "x0"}], "+", 
     RowBox[{"2", " ", "xi"}], "-", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "xr"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "p0"}], "+", "x0"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"x0", "-", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "xi"}], "-", 
        RowBox[{"2", " ", "xr"}]}], ")"}]}]}], 
    RowBox[{"p0", "+", 
     RowBox[{"\[ImaginaryI]", " ", "x0"}], "+", 
     RowBox[{"2", " ", "xi"}], "-", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "xr"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.941188951324608*^9, 3.941191144796904*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"16548899-a4d2-4c99-b5da-973e8fb4fa9f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "Equations"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"eqns", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x0", "'"}], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"I", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"p0", "[", "t", "]"}], "^", "2"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"p0", "[", "t", "]"}], " ", 
            RowBox[{"x0", "[", "t", "]"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p0", "[", "t", "]"}], "-", 
           RowBox[{"I", " ", 
            RowBox[{"x0", "[", "t", "]"}]}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"p0", "'"}], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"I", " ", 
               RowBox[{"p0", "[", "t", "]"}]}], "+", 
              RowBox[{"x0", "[", "t", "]"}]}], ")"}], " ", 
            RowBox[{"x0", "[", "t", "]"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p0", "[", "t", "]"}], "-", 
           RowBox[{"I", " ", 
            RowBox[{"x0", "[", "t", "]"}]}]}], ")"}]}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Initial", " ", "conditions"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialConditions", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"x0", "[", "0", "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{
        RowBox[{"p0", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Solve", " ", "equations"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"DSolve", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"eqns", ",", "initialConditions"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x0", "[", "t", "]"}], ",", 
       RowBox[{"p0", "[", "t", "]"}]}], "}"}], ",", "t"}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.941190020613719*^9, 3.94119014528331*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"472ae6a3-5f20-4718-b9e8-8ff5789a4a8f"],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["x0", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
      FractionBox[
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"p0", "[", "t", "]"}], "2"]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"p0", "[", "t", "]"}], " ", 
         RowBox[{"x0", "[", "t", "]"}]}]}], 
       RowBox[{
        RowBox[{"p0", "[", "t", "]"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"x0", "[", "t", "]"}]}]}]]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["p0", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        RowBox[{
         RowBox[{"x0", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"p0", "[", "t", "]"}]}], "+", 
           RowBox[{"x0", "[", "t", "]"}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"p0", "[", "t", "]"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"x0", "[", "t", "]"}]}]}]]}], ",", 
     RowBox[{
      RowBox[{"x0", "[", "0", "]"}], "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{"p0", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x0", "[", "t", "]"}], ",", 
     RowBox[{"p0", "[", "t", "]"}]}], "}"}], ",", "t"}], "]"}]], "Output",
 CellChangeTimes->{{3.941190118421464*^9, 3.941190147880129*^9}, 
   3.9411911452610273`*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"3343b415-b2b0-4126-8691-bc419c83b684"]
}, Open  ]]
},
WindowSize->{936, 1011},
WindowMargins->{{Automatic, 0}, {0, 69}},
FrontEndVersion->"12.2 for Linux x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c959d09f-1b48-427d-a1bb-456b9e9ccbd9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 3101, 75, 163, "Input",ExpressionUUID->"60137a49-2a91-4c18-b95d-8803728b1855"],
Cell[3684, 99, 1094, 29, 62, "Output",ExpressionUUID->"d711cef0-cdac-4209-be52-4ba57a5fe32b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4815, 133, 1374, 29, 119, "Input",ExpressionUUID->"6b4ee172-6b1c-4349-b30c-2d9d9c46ac70"],
Cell[6192, 164, 292, 7, 34, "Output",ExpressionUUID->"b1e2c95e-0609-4c7f-bbf4-807d6a6f6f01"],
Cell[6487, 173, 292, 7, 34, "Output",ExpressionUUID->"61ca0e2f-55f1-4761-ab7d-42b2708b874b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6816, 185, 1027, 28, 89, "Input",ExpressionUUID->"4f693eab-65e9-4505-af33-f87d7b732c95"],
Cell[7846, 215, 572, 14, 61, "Output",ExpressionUUID->"e37761b1-efaa-4efa-a692-521261505ce7"],
Cell[8421, 231, 427, 8, 38, "Output",ExpressionUUID->"f45ce7a8-b900-4fcb-b3bf-cef1467bf3ef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8885, 244, 1858, 44, 141, "Input",ExpressionUUID->"06cc94a1-2d62-4d9a-9d46-480ba8280cc7"],
Cell[10746, 290, 1489, 37, 64, "Output",ExpressionUUID->"98d42924-b0ae-4564-bf7e-2ca138698740"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12272, 332, 4048, 98, 361, "Input",ExpressionUUID->"f84e76fa-e81a-428c-9670-3371db984597"],
Cell[16323, 432, 1476, 36, 66, "Output",ExpressionUUID->"f56f1dbb-bd09-4ef4-b506-16e0d7dfbe9a"],
Cell[17802, 470, 1497, 36, 62, "Output",ExpressionUUID->"c5082a25-725a-45c7-9899-364e0cc42fa4"],
Cell[19302, 508, 1400, 34, 62, "Output",ExpressionUUID->"5c7ce784-c4e1-4cae-8d1b-3895c98ea225"],
Cell[20705, 544, 1401, 35, 62, "Output",ExpressionUUID->"6cf8d2e8-a724-4fee-aaa8-11e1944fcc05"],
Cell[22109, 581, 1478, 36, 62, "Output",ExpressionUUID->"7bcb6b7a-18a5-4515-bd50-8ce9b9a8b2d0"],
Cell[23590, 619, 1344, 32, 62, "Output",ExpressionUUID->"65b5b093-6ea0-44d9-a528-09ae4c4d2e45"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24971, 656, 1596, 37, 91, "Input",ExpressionUUID->"ddac95f2-8796-4525-b673-e752a83e32c8"],
Cell[26570, 695, 1969, 47, 64, "Output",ExpressionUUID->"35a2fcea-534f-41ed-add8-a3424c3365de"],
Cell[28542, 744, 1557, 33, 49, "Output",ExpressionUUID->"455596ef-0855-43e5-aad1-61f3c9916fe4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30136, 782, 1580, 37, 91, "Input",ExpressionUUID->"99c83999-f10d-4060-8082-a21c2e3ce3e7"],
Cell[31719, 821, 1716, 37, 63, "Output",ExpressionUUID->"b7701802-ffbf-4136-bd6c-8e294fd7073e"],
Cell[33438, 860, 1797, 39, 49, "Output",ExpressionUUID->"153c56e0-ae62-40c9-9dcb-d3903dd0b208"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35272, 904, 1399, 35, 114, "Input",ExpressionUUID->"28569653-684f-4144-b09f-b1d31710be58"],
Cell[36674, 941, 1789, 42, 63, "Output",ExpressionUUID->"bcf03459-821b-4b32-9b27-ad32c622ba93"],
Cell[38466, 985, 1080, 22, 49, "Output",ExpressionUUID->"63b1a188-ccf6-4823-92cc-66516a8de656"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39583, 1012, 1460, 38, 116, "Input",ExpressionUUID->"3deb22ee-2c91-4bfa-b328-b43a16f7bf1e"],
Cell[41046, 1052, 1770, 45, 64, "Output",ExpressionUUID->"7d0429d0-f386-4b41-841c-120a182c872a"],
Cell[42819, 1099, 1168, 26, 49, "Output",ExpressionUUID->"8bf5e24f-4093-480a-bc63-762be4337667"],
Cell[43990, 1127, 1464, 33, 49, "Output",ExpressionUUID->"504454b0-412f-4635-8ac2-d0b511806aef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45491, 1165, 1530, 39, 116, "Input",ExpressionUUID->"9ea277c0-8d96-439e-a9b7-6ee7d0721ac2"],
Cell[47024, 1206, 1664, 43, 64, "Output",ExpressionUUID->"412ffa3e-dd2a-4c07-aee6-30ff207b6a34"],
Cell[48691, 1251, 1101, 24, 49, "Output",ExpressionUUID->"27750fe2-f3ee-42c1-9471-7df41eedc694"],
Cell[49795, 1277, 1306, 29, 49, "Output",ExpressionUUID->"ab9ead74-c93c-4533-a268-c7aefca018d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51138, 1311, 1219, 32, 90, "Input",ExpressionUUID->"4aa16728-6e55-47c6-927a-181585c5e93d"],
Cell[52360, 1345, 1234, 30, 63, "Output",ExpressionUUID->"5565932f-0e86-4fe7-9f8c-78bd7b2e7b68"],
Cell[53597, 1377, 969, 22, 49, "Output",ExpressionUUID->"bdf88048-fb89-47b1-a096-3ad70ebcd5d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54603, 1404, 1239, 33, 90, "Input",ExpressionUUID->"f041cf36-f989-40c3-983f-78e4ce978532"],
Cell[55845, 1439, 1002, 24, 61, "Output",ExpressionUUID->"34c4afe8-e461-4ce0-b920-3db219a16e17"],
Cell[56850, 1465, 767, 15, 49, "Output",ExpressionUUID->"145d34ef-7c62-4e16-bdec-bdafc3cb1e34"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57654, 1485, 1520, 39, 116, "Input",ExpressionUUID->"98445d77-d8a8-4c14-b50c-2ce3017e5b21"],
Cell[59177, 1526, 1199, 27, 61, "Output",ExpressionUUID->"053a4ee3-aa78-41e0-92f8-1c8393364eec"],
Cell[60379, 1555, 1045, 23, 49, "Output",ExpressionUUID->"945c4a94-1b17-4e20-a0da-288ed2f469d8"],
Cell[61427, 1580, 1058, 23, 49, "Output",ExpressionUUID->"ba52efd1-c474-4d94-960a-81882c3873f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62522, 1608, 2485, 62, 79, "Input",ExpressionUUID->"913bcab5-fe90-4b0b-9a21-cf3068310aa6"],
Cell[65010, 1672, 2571, 68, 88, "Output",ExpressionUUID->"d192cd52-f63e-46f1-b575-9bda2ed05cec"],
Cell[67584, 1742, 1944, 51, 49, "Output",ExpressionUUID->"aa909370-15e0-4b92-a9bc-7433ac31d251"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69565, 1798, 4023, 117, 211, "Input",ExpressionUUID->"42487863-57db-4326-80a7-f08741610eab"],
Cell[73591, 1917, 1944, 53, 49, "Output",ExpressionUUID->"3455495d-f3e7-4b42-ab7d-385474f89f87"],
Cell[75538, 1972, 2027, 54, 49, "Output",ExpressionUUID->"466a77be-7f1b-4c10-835d-c93bf13f09ca"],
Cell[77568, 2028, 1989, 51, 49, "Output",ExpressionUUID->"3054c152-cc67-4636-b55f-e0ca7c936992"],
Cell[79560, 2081, 1576, 40, 49, "Output",ExpressionUUID->"b644a292-5c87-4bac-af3c-8ece951d4172"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81173, 2126, 2360, 62, 273, "Input",ExpressionUUID->"aa579d6e-dcf9-4e1b-968a-260a4a8bac83"],
Cell[83536, 2190, 1623, 52, 54, "Output",ExpressionUUID->"43c584e1-07d4-49e3-917f-9603e245f765"],
Cell[85162, 2244, 1167, 30, 55, "Output",ExpressionUUID->"31636b1c-f3c2-40ce-80b5-8e462bc8b193"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86366, 2279, 443, 9, 30, "Input",ExpressionUUID->"2de665cd-f889-4ddd-ab61-aed06cadc605"],
Cell[86812, 2290, 1109, 31, 57, "Output",ExpressionUUID->"d187f957-dbe1-4444-b1ec-980e23213b03"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87958, 2326, 273, 6, 30, "Input",ExpressionUUID->"5968b8c9-8ab5-4b2f-a2ee-6d9171e65ce2"],
Cell[88234, 2334, 1077, 30, 57, "Output",ExpressionUUID->"16548899-a4d2-4c99-b5da-973e8fb4fa9f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89348, 2369, 2439, 71, 163, "Input",ExpressionUUID->"472ae6a3-5f20-4718-b9e8-8ff5789a4a8f"],
Cell[91790, 2442, 1782, 51, 99, "Output",ExpressionUUID->"3343b415-b2b0-4126-8691-bc419c83b684"]
}, Open  ]]
}
]
*)

